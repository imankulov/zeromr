#!/usr/bin/env python
# -*- coding: utf-8 -*-
import time
from zeromr.sender import Sender
from zeromr.binutils import get_argument_parser, setup_logger


def main():
    parser = get_argument_parser()
    parser.add_argument('--delay', type=int, default=2)
    parser.add_argument('-f', '--sources-file', required=True)
    parser.add_argument('--my-socket', default='tcp://127.0.0.1:5555')
    args = parser.parse_args()
    setup_logger(args)

    with open(args.sources_file) as fd:
        source_list = [ line.strip() for line in fd.readlines() ]
    node = Sender(my_socket=args.my_socket, source_list=source_list)
    print('Starting sender with delay of {} sec'.format(args.delay))
    time.sleep(args.delay)
    node.start()


if __name__ == '__main__':
    main()
